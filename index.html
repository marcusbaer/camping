<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>Camping</title>
    <style>
        html { font-family: sans-serif; font-size: 20px; }
        body { background: rgb(58, 50, 50); color: white; }
    </style>
    <link rel="icon" href="./icon.svg" type="image/svg+xml">
    <link rel="manifest" href="manifest.json">
    <script src="./vendor/markdown-it.min.js"></script>
    <script type="module" src="./components/essential.js" async></script>
    <script type="module">
        import { installer, serviceWorker } from './modules/pwa.js';
        import './components/critical.js';

        const renderPage = () => {
            if (navigator.share) {
                shareButton.addEventListener('click', () => {
                    const url = new URL(location.href);
                    navigator.share({
                        title: 'PWA',
                        text: 'This cool PWA also supports new windows',
                        url: url.href,
                    })
                    .then(() => console.log('Successful share'))
                    .catch((error) => console.log('Error sharing', error));
                });
            } else {
                shareButton.style.display = "none";
            }

            const newWindowButton = document.querySelector('#new');
            const windows = [];
            newWindowButton.addEventListener('click', (event) => {
                const counter = windows.length + 1;
                const handler = window.open(`./details.html?counter=${counter}`, `window-${counter}`, `height=600, width=400, left=${counter * 40 + 100}, top=${counter * 40 + 100}, menubar=no, status=no, location=no, titlebar=no`);
                windows.push(handler);
            });
        }

        (async () => {
            const serviceWorkerRegistration = await serviceWorker('./sw.js', './');
            installer('#installButton');

            renderPage();
        })()
    </script>
</head>
<body>
    <header>CAMPING</header>
    <main>
        <h1>Hello from Camping</h1>
        <button id="new">Open New Window</button>
        <image-list></image-list>
        <!-- <qr-scanner></qr-scanner> -->
        <hr>
    </main>
    <footer>
        <button id="installButton">Install App</button>
        <button id="shareButton">Share</button>
    </footer>
</body>
</html>